
# 第1章 因子投资基础


## 1.1 统一视角下的因子投资


### 1.1.1 一个公式

$E[R_i] - R_f = β_i(E[R_M]R_f)$ (1.1)

- $E[R_i]$
期望
- $R_i$
为某资产i的收益率
- $R_f$
为无风险收益率，
- $R_M$
为市场组合的预期收益率。
- $β_i=cov(R_i,R_M)/var(R_M)$
刻画了该资产收益对市场收益的敏感程度，它也被称为资产i对市场风险的暴露程度。

CAPM正是最简单的线性因子模型，它指出资产的预期超额收益率由市场组合的预期超额收益率和资产对市场风险的暴露大小决定，而市场组合也被称为市场因子。

Ross(1976)提出了著名的套利定价理论(Arbitrage Pricing Theory，APT)


$E[R_i^e] = β'_iλ$ (1.2)

- $E[R_i^e]$
资产i的预期超额收益,此约定俗成在称呼上舍去“超额”二字而仅用预期收益率。
- $β'_i$
资产i的因子暴露(factor exposure)或称因子载荷(factor loading)
- $λ$
因子预期收益(factorexpectedreturn)，也常被称为因子溢价(factorriskpremium)[2]。

式(1.2)中引入符号代表预期超额收益而舍弃了$E[R_i] - R_f$。

对于个股或者由若干支股票组成的纯多头投资组合这类资产，它的预期超额收益是$E[R_i]$和无风险收益率$R_f$之差，即$(E[R_i] - R_f)$
在实证资产定价中，另一类常见的资产是通过多空对冲构建的资金中性投资组合，例如做多一定金额的股票，同时做空同样金额的股票。依照定义，这类资产的预期超额收益率就是多头和空头预期收益之差，无须额外减去无风险收益率。因此，使用代表资产的预期超额收益更具一般性。

在多因子模型研究的术语中，不同资产预期收益率的差异通常被称为(横)截面(cross-sectional)差异，给定因子的预期收益率，资产预期收益率的高低由它在这些因子上的暴露$β'_i$大小决定。

$E[R_i^e] = α_i + β'_iλ$ (1.3)

![](https://suzixinblog.oss-cn-shenzhen.aliyuncs.com/20220910093851.png)

$α_i$就是资产i的实际预期收益率和多因子模型隐含的预期收益率之间的定价误差

该误差产生的原因可以从以下两方面来考虑：
(1)模型设定偏误，即式(1.2)右侧遗漏了重要的因子。当被遗漏的因子被加入后，即可消除误差。  
(2)模型本身没有问题，但由于资产收益率的实际数据仅仅是总体的一个样本，因此误差总是存在的。这时需要通过统计方法检验误差$α_i$是否显著不为零：  
- 如果$α_i$并非显著的偏离零，那么可以认为它的出现仅仅是因为运气的原因；
- 如果$α_i$**显著偏离零**，它则代表了**某个可以通过套利而获得超额收益的机会**[3]；它也同时说明由于某些原因，市场对该资产出现错误定价(mispricing)，从而导致其实际预期收益率和多因子模型下的预期收益率出现了偏离。

如何选择因子来构建多因子模型，如何计算资产在因子上的暴露以及因子的收益率，如何使用统计学的方法对定价误差$α_i$进行正式检验就成了使用多因子模型研究资产定价时必须回答的问题。

### 1.1.2 因子、多因子模型和异象
$β'_iλ$中包含了多个影响式(1.3)左侧资产收益率的解释变量，每个解释变量代表了一个因子。

多个因子的预期收益率以及资产在它们上的暴露放在一起构成的就是多因子模型, $β'_iλ$这个整体是多因子模型， 每个解释变量$β'_i$代表一个因子。对于某个给定的资产i，如果它的实际预期收益率和多因子模型隐含的预期收益率之间的误差$α_i$显著不为零，则称这个资产为一个异象(anomaly)。

> **因子的定义**： 一个因子描述了众多资产共同暴露的某种系统性风险，该风险是资产收益率背后的驱动力；因子收益率正是这种系统性风险的风险溢价或风险补偿，它是这些资产的共性收益。

Ang(2014)将因子之于资产类比于营养之于食物。人们的日常生活离不开摄入各种食物，比如米饭、谷物、肉类和乳制品等。这些食物之所以对人体重要是因为它们所包含的营养成分，例如水、碳水化合物、蛋白质、纤维和脂肪等。这些营养成分就是食物的“因子”。每种食物对人体的价值体现在两方面：
(1)它包含哪些营养成分以及包含了多少(类比多因子模型中的$β'_i$)；  
(2)该食品包含的每种营养成分对人体健康的重要性(类比多因子模型中的$λ$)。  
因此，虽然食物种类五花八门，但归根结底它们都可以归结为不同营养成分的组合；同理，虽然股票资产的组合形式成百上千，但归根结底它们都可以归结为不同因子的组合。这就是因子的作用和多因子模型的价值。

从上述定义可以总结出因子需要满足的两个必要条件：
(1)因子驱动了资产收益率的共同运动(comovement)，因此因子一定和资产收益率的协方差矩阵有关；  
(2)从长期来看因子是可以获得正收益的，这意味着因子必须是被定价的。明确了因子的定义，下面再来看看什么是多因子模型。  

如何确定一个多因子模型中到底有几个以及哪些因子，可以从以下两点考虑。
- 加入模型的因子是相互独立的
首先，很多因子之间都存在一定的相关性，高度相关的因子代表的是资产收益率所暴露的同一类风险。在选择模型包括的因子时，必须要考虑相关性的影响，人们希望加入模型的因子是相互独立的、每个因子都能对解释资产预期收益率截面差异有显著的增量贡献。
- 考虑简约法则(The Law of Parsimony)
学术界的主流多因子模型通常包括3～5个因子，本书的第4章将对这些模型进行系统的阐述。  


### 1.1.3 再论异象和因子
$β'_iλ$是一个定价模型，因此它包含的因子又被称为定价因子(pricing factors)；而$α_i$代表的是按某种方法构建出的能够获得多因子模型无法解释的超额收益的资产，因此它又被称为异象因子(anomaly factors)。

### 1.1.4 因子投资包含的内容
- 关注于$β'_i$的研究
学术界关注的是找到“最好”的多因子模型。“最好”通常意味着在该模型下资产的$α_i$尽可能接近零，即该模型无法解释的异象越少越好。大量的实证数据研究表明，在选择了适当的多因子模型后，绝大多数主动基金管理人并不能获得超额收益。

业界进行因子投资最重要的目标是使用因子来获取超过基准的收益。因此业界从资产配置的角度聚焦于找到从长期来看有风险溢价的因子(即$λ$大)，并以尽可能高的暴露(即$β'_i$高)配置在这些因子上

------

- 关注于$α_i$的研究
$α_i$代表了可以通过套利获得的超额收益。

先说学术界，从有效市场假说(Efficient Market Hypothesis，出自Fama 1970)的观点出发，如果多因子模型不存在模型设定偏误，那么市场中不应该存在太多异象。

**解释异象的能力是评价多因子模型优劣的重要标准之一**。比如两个多因子模型A和B，如果使用模型A时异象的个数少于使用模型B时异象的个数，就会认为模型A比模型B更好。模型之间的对比也从侧面推动了对异象的研究。

业界并不严格区分定价因子和异象因子。在业界看来，一个因子是否被纳入某个定价模型(从而从异象因子转变为定价因子)并不重要，而更关心在考虑了交易成本之后，使用该因子是否仍然能够获得超额收益。

------


- 截面角度vs时序角度
从数学定义可知，预期收益率是收益率在时间序列上的平均，因此均值的模型仅关心不同资产的收益率均值为什么会有差异，而非每个资产的收益率如何随时间变化。把式(1.3)沿时间轴展开，资产超额收益和因子收益率在时序上满足如下多元线性回归模型：

$$
\begin{aligned}
E[R_{it}^e] = α_i + β'_iλ_t + ξ_{it} (1.4)
\end{aligned}
$$

- $E[R_{it}^e]$
表示t时刻资产i的超额收益
- $λ_t$
表示t时刻因子收益率
- $ξ_{it}$
表示t时刻的随机扰动

这就是研究多因子模型的时间角度。图1.2展示了截面角度和时序角度之间的切换。

![](https://suzixinblog.oss-cn-shenzhen.aliyuncs.com/20220824115617.png)

随机扰动随着时间回归之后$E(ξ_{it})=0$

$$
\begin{aligned}
R_{t}^e &= α + βλ_t + ξ_{t} (1.5) \\
N维超额收益向量：R_{t}^e &= [R_{1t}^e, R_{2t}^e, ..., R_{Nt}^e]' \\
N维定价误差向量 ：α &= [α_{1}, α_{2}, ..., α_{N}]' \\
N*K因子暴露矩阵 ：β &= [β_{1}, β_{2}, ..., β_{N}]' \\
N维随机扰动因子 ： ξ_{t} &= [ξ_{1t}, ξ_{2t}, ..., ξ_{Nt}]' \\
\end{aligned} 
$$

这里的K指的是因子数量，N是资产数量，参考投资科学中多因子模型中的推导。

对式(1.5)两侧求协方差矩阵
$$
\begin{aligned}
由cov(λ_t,ε_t)&=0可得 \\
Σ&=βΣ_λβ'+Σ_ε　(1.6) \\
Σ(N阶矩阵)&= N个资产的协方差矩阵 \\
Σ_λ(K阶矩阵)&= K个因子的协方差矩阵 \\
Σ_ε(N阶矩阵)&= N个随机扰动的协方差矩阵 \\
由于ε_{it}相互独立，因此Σε是一个对角阵。
\end{aligned} 
$$

式（1.6）就是关于方差的模型。